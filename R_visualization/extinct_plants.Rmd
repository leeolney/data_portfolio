---
title: "Extinct Plants"
output: html_notebook
---
**Notebook description**: Basic data visualization practice 

**Data source**: TidyTuesday [Extinct plants](https://github.com/rfordatascience/tidytuesday/blob/master/data/2020/2020-08-18/readme.md)

Load packages
```{r, message = FALSE, warning = FALSE}
library(tidyverse)
library(readr)
library(ggthemes)
library(ggsci)
library(viridis)
```

Import data
```{r, message = FALSE, warning = FALSE}
plants <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-08-18/plants.csv')
actions <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-08-18/actions.csv')
threats <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-08-18/threats.csv')
```

```{r}
dim(plants)
dim(actions)
dim(threats)
```

Extinct plants by last_year_seen (500 plants are considered to be extinct in 2020)
```{r}
plants %>% filter(!is.na(year_last_seen)) %>% group_by(year_last_seen) %>% tally() %>% ggplot(aes(x= factor(year_last_seen, level = c('Before 1900','1900-1919','1920-1939', '1940-1959','1960-1979','1980-1999','2000-2020')), y=n, fill=n)) + geom_col(width=0.6) + geom_text(aes(label=n, vjust=-0.5)) + theme_light() + scale_fill_viridis(option="cividis") + labs(x="", y="", fill="", title= "Year last seen of 500 extinct plants") + theme(
    panel.grid.major.x = element_blank(),
    panel.border = element_blank(),
    axis.ticks.x = element_blank(),
    axis.ticks.y = element_blank(),
    panel.grid.major.y = element_blank(),
    panel.grid.minor.x = element_blank(),
    panel.grid.minor.y = element_blank(),
    legend.position="none"
  ) 
```

Threat type of extinct plants
```{r}
threats %>% filter(threatened=="1", !is.na(year_last_seen), threat_type!= 'Unknown') %>% group_by(threat_type) %>% tally() %>% ggplot(aes(x=reorder(threat_type,n), y=n, fill=n)) + geom_col() + scale_fill_viridis() + coord_flip() + theme_light() + labs(x="", y="", fill="", title= "Threat types of extinct plants") + theme(
    panel.grid.major.x = element_blank(),
    panel.border = element_blank(),
    axis.ticks.x = element_blank(),
    axis.ticks.y = element_blank(),
    panel.grid.major.y = element_blank(),
    panel.grid.minor.x = element_blank(),
    panel.grid.minor.y = element_blank()
  ) 
```

Proportion of threat types by year last seen (1900 and after)
```{r}
threats %>% filter(threatened=="1", !is.na(year_last_seen), threat_type!= 'Unknown', year_last_seen!='Before 1900') %>% group_by(year_last_seen, threat_type) %>% tally() %>% mutate(prop= n/sum(n)) %>% ggplot(aes(x= threat_type, y= prop, fill=year_last_seen)) + geom_col() + coord_flip() + facet_wrap(~year_last_seen) + theme_minimal()  + scale_fill_uchicago() + theme(legend.position="none") + labs(y="proportion") + theme(
    panel.grid.major.x = element_blank(),
    panel.border = element_blank(),
    axis.ticks.x = element_blank(),
    axis.ticks.y = element_blank(),
    panel.grid.major.y = element_blank(),
    panel.grid.minor.x = element_blank(),
    panel.grid.minor.y = element_blank()
  ) 
```

Summary of extinct plants by continent 
```{r}
plants %>% group_by(continent) %>% tally(sort=T) %>% mutate(prop=n/sum(n))
```
Proportion of extinct plants by continent 
```{r}
plants %>% group_by(continent) %>% tally(sort=T) %>% mutate(prop=n/sum(n)) %>% ggplot(aes(x=reorder(continent,prop), y=prop, fill=prop)) + geom_col() + coord_flip() + geom_text(aes(label=n, hjust=-0.3)) + ylim(0.0,0.5) + labs(y="proportion", x= "", title = "Extinct plants by continent", fill="Proportion") + scale_fill_viridis() + theme_light() + theme(
    panel.grid.major.x = element_blank(),
    panel.border = element_blank(),
    axis.ticks.x = element_blank(),
    axis.ticks.y = element_blank(),
    panel.grid.major.y = element_blank(),
    panel.grid.minor.x = element_blank(),
    panel.grid.minor.y = element_blank()
  ) 
```

year_last_seen by continent (inspired by kllycttn)
```{r}
plants %>% filter(!is.na(year_last_seen)) %>% ggplot(aes(x= factor(year_last_seen, level = c('2000-2020','1980-1999','1960-1979', '1940-1959','1920-1939','1900-1919','Before 1900')), fill= continent))  + geom_bar() + coord_flip() + facet_wrap(~continent) + theme_minimal() + ggthemes::scale_fill_tableau() + labs(x="year_last_seen") + theme(
    panel.grid.major.x = element_blank(),
    panel.border = element_blank(),
    axis.ticks.x = element_blank(),
    axis.ticks.y = element_blank(),
    panel.grid.minor.x = element_blank(),
    panel.grid.minor.y = element_blank(),
    legend.position="none"
  ) 
```

Proportion of threat types by continent 
```{r}
threats %>% filter(threatened=="1") %>% filter(!is.na(year_last_seen)) %>% filter(threat_type!= 'Unknown') %>% group_by(continent, threat_type) %>% tally() %>% mutate(prop= n/sum(n)) %>% ggplot(aes(x= threat_type, y= prop, fill=continent)) + geom_col() + coord_flip() + facet_wrap(~continent) + theme_minimal()  + ggthemes::scale_fill_tableau() + labs(y="proportion") + theme(
    panel.grid.major.x = element_blank(),
    panel.border = element_blank(),
    axis.ticks.x = element_blank(),
    axis.ticks.y = element_blank(),
    panel.grid.minor.x = element_blank(),
    panel.grid.minor.y = element_blank(),
    legend.position="none"
  ) 
```

Actions taken by continents (inspired by kllycttn)
```{r}
actions %>% filter(action_taken=="1") %>% group_by(continent, action_type) %>% tally() %>% filter(action_type !='Unknown') %>% ggplot(aes(x=n, y=action_type, fill= action_type)) + geom_col() + facet_wrap(~continent) + theme_minimal() + scale_fill_uchicago() + theme(legend.position="none") + labs(x="", y="") + theme(
    panel.grid.major.x = element_blank(),
    panel.border = element_blank(),
    axis.ticks.x = element_blank(),
    axis.ticks.y = element_blank(),
    panel.grid.minor.x = element_blank(),
    panel.grid.minor.y = element_blank()
  ) 
```

Red list category across the years (inspired by iamericfletcher) 
```{r}
plants %>% filter(!is.na(year_last_seen)) %>% group_by(year_last_seen, red_list_category) %>% tally() %>% ggplot(aes(x= factor(year_last_seen, level = c('Before 1900','1900-1919','1920-1939', '1940-1959','1960-1979','1980-1999','2000-2020')), y = n, fill= red_list_category)) + geom_col(position="dodge") + labs(x="") +  scale_fill_manual(name = "", labels = c("Extinct", "Extnct in the Wild"), values = c("#7d8597", "#ad2831")) + labs(x="", y="", title = "Extinct vs Extinct in the Wild") + theme_light() + theme(
    panel.grid.major.x = element_blank(),
    panel.border = element_blank(),
    axis.ticks.x = element_blank(),
    axis.ticks.y = element_blank(),
    panel.grid.major.y = element_blank(),
    panel.grid.minor.x = element_blank(),
    panel.grid.minor.y = element_blank()
  ) 
```

