---
title: "Women Entrepreneurship"
output: html_notebook
---
### Visualization and statistical testing exercise 

Dataset: [Women Entrepreneurship and Labor Force](https://www.kaggle.com/babyoda/women-entrepreneurship-and-labor-force)

Task: [Non-Parametric Tests in Entrepreneurship Data](https://www.kaggle.com/babyoda/women-entrepreneurship-and-labor-force/tasks?taskId=2742):   
  1. Are European Union membership variable and development variable independent from each other? (Method Chi-Square Test and Crosstab)  
  
  2. Do the Women Entrepreneurship Index and Global Entrepreneurship Index values show a statistically significant difference between the countries that are members of the European Union and not? (Method Mann-Whitney U)   
  
  3. Is there a statistically significant relationship between Women's Entrepreneurship Index and Global Entrepreneurship Index values? (Method Spearman Correlation Coefficient)   

Reference notebooks:    

  * [Autumn of Matriarch: The complete guide to EDA - 1](https://www.kaggle.com/ritikpnayak/autumn-of-matriarch-the-complete-guide-to-eda-1)  
  * [Women Entrepreneurs Analysis](https://www.kaggle.com/arushchillar/women-entrepreneurs-analysis)  
  * [Women Entr. Analysis and Non-Parametric Tests](https://www.kaggle.com/fatihb/women-entr-analysis-and-non-parametric-tests)  
  * [Women Entrepreneurship Data Analysis](https://www.kaggle.com/ayushmehar7/women-entrepreneurship-data-analysis)  
  * [Clustering:Women Entrepreneurship and Labor Force](https://www.kaggle.com/nalkrolu/clustering-women-entrepreneurship-and-labor-force)  

#### Load packages
```{r, message=FALSE, warning=FALSE}
library(tidyverse)
library(broom)
library(GGally)
library(ggrepel)
library(sf)
library(rnaturalearth)
library(rnaturalearthdata)
library(rgeos)
library(skimr)
library(ggsci)
```

#### Import data
```{r}
df <- read_csv2("women_entrepreneurship.csv")
dim(df)
```

#### Summary
```{r}
df$`Level of development` <- as.factor(df$`Level of development`)
df$`European Union Membership` <- as.factor(df$`European Union Membership`)
df$Currency <- as.factor(df$Currency)
df$`Inflation rate` <- as.numeric(df$`Inflation rate`)
```

```{r}
skim(df)
```

### Part 1: Visualization
#### Choropleth

```{r}
world <- ne_countries(scale = "medium", returnclass = "sf")
df2 <- df
colnames(df2)[2] <- "name"
world2 <- full_join(world, df2, by = "name")
```


```{r}
world2 %>% ggplot() +
  geom_sf(aes(fill = `Women Entrepreneurship Index`)) +
  coord_sf(expand = FALSE) +
  theme_bw() +
  theme(legend.position = "bottom",
        legend.margin = margin(-3,-3,-3,-3)) +
  labs(fill = "") +
  ggtitle("Women Entrepreneurship Index")
```


```{r}
# EMEA
world2 %>% ggplot() +
  geom_sf(aes(fill = `Women Entrepreneurship Index`)) +
  coord_sf(xlim = c(-25, 65),
           ylim = c(15, 75),
           expand = FALSE) +
  theme_bw() +
  theme(legend.position = "bottom",
        legend.margin = margin(-3,-3,-3,-3)) +
  labs(fill = "") +
  ggtitle("Women Entrepreneurship Index",
          subtitle = "EMEA")
```

```{r}
# APAC
world2 %>% ggplot() +
  geom_sf(aes(fill = `Women Entrepreneurship Index`)) +
  coord_sf(xlim = c(60, 185),
           ylim = c(-50, 60),
           expand = FALSE) +
  theme_bw() +
  theme(legend.position = "bottom",
        legend.margin = margin(-3,-3,-3,-3)) +
  labs(fill = "") +
  ggtitle("Women Entrepreneurship Index",
          subtitle = "APAC")
```

```{r}
# latin america
world2 %>% ggplot() +
  geom_sf(aes(fill = `Women Entrepreneurship Index`)) +
  coord_sf(xlim = c(-125, -20),
           ylim = c(-60, 35),
           expand = FALSE) +
  theme_bw() +
  theme(legend.position = "bottom",
        legend.margin = margin(-3,-3,-3,-3)) +
  labs(fill = "") +
  ggtitle("Women Entrepreneurship Index",
          subtitle = "Latin America")
```


#### Pairplot

```{r, message=FALSE}
df %>% ggpairs(columns = 6:9,
               mapping = ggplot2::aes(color = `European Union Membership`),
               legend = 1,
               diag = list(continuous = wrap("densityDiag", position = "stack")),
               columnLabels = c("Women Entr IDX", "Entr IDX",
                                "Inflation Rate", "Female Participation Rate"),
               title = "Variables by EU Membership") +
  theme(legend.position = "top",
        legend.justification = "left",
        legend.margin = margin(-1,-1,-1,-1)) +
  labs(fill = "") +
  scale_color_manual(values = c("cadetblue", "goldenrod")) +
  scale_fill_manual(values = c("cadetblue", "goldenrod"))
```

```{r,message=FALSE}
df %>% ggpairs(columns = 6:9,
               mapping = ggplot2::aes(color = `Level of development`),
               legend = 1,
               diag = list(continuous = wrap("densityDiag", position = "stack")),
               columnLabels = c("Women Entr IDX", "Entr IDX",
                                "Inflation Rate", "Female Participation Rate"),
               title = "Variables by Level of Development") + theme_bw() +
  theme(legend.position = "top",
        legend.justification = "left",
        legend.margin = margin(-1,-1,-1,-1)) +
  labs(fill = "") +
  scale_fill_manual(values = wes_palette("Royal1")) +
  scale_color_manual(values = wes_palette("Royal1")) 
```

#### WEI by countries and EU memebership
```{r}
df %>%
  ggplot(aes(reorder(Country, `Women Entrepreneurship Index`), `Women Entrepreneurship Index`,
             fill = `European Union Membership`)) +
  geom_bar(stat = "identity", color = "white") +
  scale_y_continuous(expand = c(0,0), 
                     limits = c(0,800)) +
  labs(fill = "") + theme_bw() +
  theme(axis.text.x = element_text(angle = 60, hjust = 1, vjust = 1), 
        axis.title.x = element_blank(),
        legend.position = "top",
        legend.justification = "left",
        legend.margin = margin(-1,-1,-1,-1),
        panel.grid.major.x = element_blank()
        ) +
  scale_fill_manual(values = c("cadetblue", "goldenrod")) +
  ggtitle("Women Entrepreneurship Index", 
          subtitle = "By Countries and EU Membership")
```

#### WEI by countries and level of development
```{r}
df %>%
  ggplot(aes(reorder(Country, `Women Entrepreneurship Index`), `Women Entrepreneurship Index`,
             fill = `Level of development`)) +
  geom_bar(stat = "identity", color = "white") +
  scale_y_continuous(expand = c(0,0), 
                     limits = c(0,800)) +
  labs(fill = "") + theme_bw() +
  theme(axis.text.x = element_text(angle = 60, hjust = 1, vjust = 1), 
        axis.title.x = element_blank(),
        legend.position = "top",
        legend.justification = "left",
        legend.margin = margin(-1,-1,-1,-1),
        panel.grid.major.x = element_blank()) +
  scale_fill_manual(values = wes_palette("Royal1")) +
  ggtitle("Women Entrepreneurship Index", 
          subtitle = "By Countries and Level of Development")
```

### Part 2: Tests
#### Task 1: Are European Union membership variable and development variable independent from each other? (Method Chi-Square Test and Crosstab)

```{r}
df %>% ggplot(., aes(`Level of development`, fill = `European Union Membership`)) +
  geom_bar(color = "dimgrey") +
  ggtitle("Development and EU Membership") +
  theme(legend.position = "top",
        legend.justification = "left",
        legend.margin = margin(-1,-1,-1,-1)) +
  scale_fill_manual(values = c("cadetblue", "goldenrod")) +
  labs(fill = "")
```

None of the developing countries are EU members, so even before the Chi-square test we can say that EU membership and level of development are not independent.

H0: EU Membership and Level of Development variables are independent from each other.
H1: EU Membership and Level of Development variables are not independent from each other.

```{r}
crosstab <- table(df$`Level of development`, df$`European Union Membership`)
crosstab 
chisq.test(crosstab)
```

* EU membership and level of development are not independent from each other.

#### Task 2: Do the Women Entrepreneurship Index and Global Entrepreneurship Index values show a statistically significant difference between the countries that are members of the European Union and not? (Method Mann-Whitney U)

```{r}
df %>% ggplot(., aes(`Level of development`, `Women Entrepreneurship Index`)) +
  geom_boxplot(outlier.shape = 4) +
  geom_jitter(aes(color = `European Union Membership`), width = 0.1) +
  scale_color_manual(values = c("cadetblue", "goldenrod")) +
  theme(axis.title.x = element_blank(),
        legend.position = "top",
        legend.justification = "left",
        legend.margin = margin(-1,-1,-1,-1)) +
  labs(color = "") +
  ggtitle("Women Entrepreneurship Index", 
          subtitle = "by Level of Development and EU Membership")
```

H0: The Women Entrepreneurship Index values do not show a statistically significant difference between the countries that are members of the European Union and not.
H1: The Women Entrepreneurship Index values show a statistically significant difference between the countries that are members of the European Union and not.

```{r}
v.member.women <-  df %>% 
  filter(`European Union Membership` == "Member") %>% 
  .$`Women Entrepreneurship Index`

v.notmember.women <- df %>% 
  filter(`European Union Membership` == "Not Member") %>% 
  .$`Women Entrepreneurship Index`

u.test.women <- wilcox.test(v.member.women, v.notmember.women)
u.test.women
```

The Women Entrepreneurship Index values do show a statistically significant difference between the countries that are members of the European Union and not, as the Wilcoxon rank sum test (also known as Method Mann-Whitney U test) supports the alternative hypothesis with extremely low error. 

```{r}
df %>% ggplot(., aes(`Level of development`, `Entrepreneurship Index`)) +
  geom_boxplot(outlier.shape = 4) +
  geom_jitter(aes(color = `European Union Membership`), width = 0.1) +
  scale_color_manual(values = c("cadetblue", "goldenrod")) +
  theme(axis.title.x = element_blank(),
        legend.position = "top",
        legend.justification = "left",
        legend.margin = margin(-1,-1,-1,-1)) +
  labs(color = "") +
  ggtitle("Entrepreneurship Index", 
          subtitle = "by Level of Development and EU Membership")
```

The boxplots of Entrepreneurship Index looks similar to the other with Women Entrepreneurship Index as they are mostly correlated.

H0: The Entrepreneurship Index values do not show a statistically significant difference between the countries that are members of the European Union and not.
H1: The Entrepreneurship Index values show a statistically significant difference between the countries that are members of the European Union and not.

```{r}
v.member.entr <- df %>% 
  filter(`European Union Membership` == "Member") %>% 
  .$`Entrepreneurship Index`

v.notmember.entr <- df %>% 
  filter(`European Union Membership` == "Not Member") %>% 
  .$`Entrepreneurship Index`

u.test.entr <- wilcox.test(v.member.entr, v.notmember.entr)
u.test.entr
```

* We can accept that The Entrepreneurship Index values show a statistically significant difference with EU membership. 


#### Task 3: Is there a statistically significant relationship between Women's Entrepreneurship Index and Global Entrepreneurship Index values? (Method Spearman Correlation Coefficient)


```{r, fig.height=4, fig.width=4}
df.odds <- df %>% filter(`Women Entrepreneurship Index` < 200 |
                           `Entrepreneurship Index` < 200)
lm.fit <- df %>% lm(., formula = `Women Entrepreneurship Index` ~ `Entrepreneurship Index`)

df %>% ggplot(aes(`Entrepreneurship Index`, `Women Entrepreneurship Index`)) +
  geom_point(aes(color = `European Union Membership`)) +
  geom_label_repel(data = df.odds, aes(`Entrepreneurship Index`, `Women Entrepreneurship Index`, label = Country),
                   alpha = .7,
                   arrow = arrow(length = unit(2, "mm"), type = "closed", ends = "first"),
                   nudge_y = 50) +
  labs(color = "") + theme_bw() +
  theme(legend.position = "top",
        legend.justification = "left",
        legend.margin = margin(-1,-1,-1,-1)) +
  scale_color_manual(values = c("cadetblue", "goldenrod")) + 
  stat_smooth(method = "lm", se = FALSE, linetype = "dashed", color = "black", formula = y ~ x) +
  annotate("text", x = 100, y = 700, label = "italic(R)^2==0.425", parse = TRUE) +
  ggtitle("Global Entrepreneurship Index", 
          subtitle = "Women Entr. Index on Entr. Index")
```

* There is some relationship between women's entrepreneurship index and global entrepreneurship index values. 

```{r}
cor.test(df$`Women Entrepreneurship Index`, df$`Entrepreneurship Index`, method = "spearman")
```

* We can accept that there is a correlation between global entrepreneurship index and women entrepreneurship index.